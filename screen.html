<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Screen</title>
<style>
  body {
    margin: 0;
    background: #1b212c;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    display: block;
    background: white;
    max-width: 100%;
    max-height: 100%;
  }
</style>
</head>
<body>
<canvas id="pdfCanvas"></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
window.addEventListener("load", async () => {
    if (typeof pdfjsLib === "undefined") {
        alert("PDF.js failed to load!");
        return;
    }

    const url = "prez.pdf";
    const canvas = document.getElementById("pdfCanvas");
    const ctx = canvas.getContext("2d");
    const time = 10;

    pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

    let pdfDoc = await pdfjsLib.getDocument(url).promise;
    let pageNum = 1;
    let totalPages = pdfDoc.numPages;
    let currentPageViewport = null; // store viewport for resize

    async function renderPage(num) {
        const page = await pdfDoc.getPage(num);

        // Calculate scale based on window size
        const unscaledViewport = page.getViewport({ scale: 1 });
        const scale = Math.min(
            window.innerWidth / unscaledViewport.width,
            window.innerHeight / unscaledViewport.height
        );
        currentPageViewport = page.getViewport({ scale });

        canvas.width = currentPageViewport.width;
        canvas.height = currentPageViewport.height;

        await page.render({ canvasContext: ctx, viewport: currentPageViewport }).promise;
    }

    async function nextPage() {
        await renderPage(pageNum);
        pageNum++;
        if (pageNum > totalPages) {
            location.reload();
        } else {
            setTimeout(nextPage, time * 1000);
        }
    }

    // Re-render current page on resize
    window.addEventListener("resize", () => {
        if (pageNum > 1) {
            renderPage(pageNum - 1);
        }
    });

    nextPage();
});
</script>
</body>
</html>
